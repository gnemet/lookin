graph LR
    subgraph INTERFACES["ğŸ“ Interfaces"]
        AIC["AIClient"]
        RAG["RAGProvider"]
        SQL["SQLExecutor"]
    end

    subgraph PIPELINE["âš¡ RunPipeline"]
        S1["Stage 1<br/>NL â†’ SQL"]
        S2["Stage 2<br/>SQL â†’ Execute"]
        S3["Stage 3<br/>Results â†’ NL"]
        REPAIR["ğŸ”§ Auto-Repair<br/>SQL Fix Loop"]
    end

    subgraph SUPPORT["ğŸ§© Support"]
        PERSONA["ğŸ“ Persona Loader<br/>embed.FS"]
        FEEDBACK["ğŸ“Š Feedback<br/>YAML + JSONL"]
        AUDIT["ğŸ“‹ Audit Log<br/>rag.audit_log"]
        UTILS["ğŸ”¨ Utils<br/>ExtractSQL Â· RLS"]
    end

    subgraph ADAPTERS["ğŸ”Œ Adapters"]
        JM_A["jiramntrAIClient<br/>jiramntrRAGProvider<br/>jiramntrSQLExecutor"]
        JO_A["johannaAIClient<br/>johannaRAGProvider<br/>johannaSQLExecutor"]
    end

    AIC --> S1
    RAG --> S1
    S1 --> S2
    S1 --> REPAIR
    REPAIR --> S1
    SQL --> S2
    S2 --> S3
    AIC --> S3
    S3 --> FEEDBACK
    S3 --> AUDIT
    PERSONA --> S1
    PERSONA --> S3
    JM_A -.-> INTERFACES
    JO_A -.-> INTERFACES
