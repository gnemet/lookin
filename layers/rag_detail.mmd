graph LR
    subgraph MCP_GEN["ðŸ“‹ MCP Generation"]
        CATALOG["generate_catalog.py"]
        JSON["30 JSON catalogs"]
        CHAINS["12 chain MCPs (.md)"]
        FULL["dwh_mcp.md (monolithic)"]
        CATALOG --> JSON
        CATALOG --> FULL
    end

    subgraph EMBED["ðŸ§² Embedding"]
        GEMINI["Gemini Embedding API"]
        PGVEC["meta.mcp_embeddings<br/>pgvector (HNSW)"]
        CHAINS --> GEMINI --> PGVEC
    end

    subgraph RETRIEVAL["ðŸ“š Runtime (2 modes)"]
        QUESTION["User Question"]
        VEC_SEARCH["Vector Search<br/>Top-K chunks"]
        DIRECT["Direct MCP<br/>(full file)"]
        CONTEXT["MCP Context"]

        QUESTION --> VEC_SEARCH
        PGVEC --> VEC_SEARCH --> CONTEXT
        FULL --> DIRECT --> CONTEXT
    end
